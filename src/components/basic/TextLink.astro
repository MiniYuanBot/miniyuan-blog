---
// The <TextLink /> component creates consistent HTML text links with customizable backgrounds

import type { HTMLAttributes } from "astro/types";

type Props = HTMLAttributes<"a"> & {
    isMobile?: boolean;
    delay?: string | number;
};

const {
    href,
    class: className,
    isMobile = false,
    delay,
    ...props
} = Astro.props;

const pathname = Astro.url.pathname.replace(import.meta.env.BASE_URL, "");
const subpath = pathname.match(/[^\/]+/g);
const isActive = href === pathname || href === "/" + (subpath?.[0] || "");

// Build style object for initial state
const styleObj: Record<string, string> = {};

if (delay !== undefined) {
    styleObj["animation-delay"] =
        typeof delay === "number" ? `${delay}ms` : delay;
}
---

<a
    href={href}
    class:list={[
        className,
        !isMobile && [
            "desktop-nav-item",
            "desktop-nav-text",
            isActive && "font-semibold text-accent desktop-active-indicator",
        ],
        isMobile && [
            "mobile-menu-item-base",
            "mobile-menu-text",
            isActive && "font-semibold text-accent mobile-active-indicator",
        ],
    ]}
    style={styleObj}
    aria-current={isActive ? "page" : undefined}
    {...props}
>
    <slot />
</a>
