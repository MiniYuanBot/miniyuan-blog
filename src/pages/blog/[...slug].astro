---
import { type CollectionEntry, getCollection, render } from 'astro:content';
import BlogPost from '@/layouts/BlogPost.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.id },
		props: post,
	}));
}
type Props = CollectionEntry<'blog'>;

const post = Astro.props;

// convert string to Data object
const postWithDates = {
	...post,
	data: {
		...post.data,
		pubDate: new Date(post.data.pubDate),
		updatedDate: post.data.updatedDate ? new Date(post.data.updatedDate) : undefined,
	}
};

const { Content } = await render(postWithDates);
---

<BlogPost {...postWithDates.data}>
	<Content />
</BlogPost>
